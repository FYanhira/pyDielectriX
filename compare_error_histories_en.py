import numpy as np
import matplotlib.pyplot as plt

# Paste your LM and BO error histories here (replace with your actual data)
lm_real = [199.52257618429164, 199.52257618429164, 199.52257618429164, 199.51945362261867, 199.52257126702094, 199.52257864294984, 199.5225737256335, 199.52257618429164, 199.52257618429164, 199.52257618429164, 199.52257618429164, 199.52257618429164, 199.52257618429164, 249.66052813866523, 251.70678363147331, 251.77769705360865, 251.350404105064, 251.21269091700734, 249.24805278391082, 251.17301470703796, 168.8823802729651, 168.87967852157524, 168.8816107003589, 168.88260009490193, 168.88147844499042, 168.88240399508288, 168.88240399508288, 168.8825217356046, 168.8823802957319, 168.8823802957319, 168.8823804088446, 131.36196099815717, 131.36007563741032, 131.3102594799242, 131.36196099815717, 131.36196099815714, 131.3621985162768, 131.3621985162768, 131.36196099815717, 131.3625921431918, 131.3625921431918, 131.36196099815717, 82.34774401618411, 82.34740872704448, 82.31904595294098, 82.3477440161841, 82.34774401618407, 82.34780855948456, 82.34780855948456, 82.34774401618411, 82.348299508611, 82.34829950861098, 82.34774401618408, 86.98317089318645, 77.14028552007711, 77.14047833486289, 77.13960451500436, 77.14028552007711, 77.14028552007709, 77.14032197152112, 77.14032197152122, 77.14028552007711, 77.1400575297286, 77.14005752972857, 77.14028552007711, 79.43079639207129, 75.44294217958266, 75.44314244252607, 75.44237688543876, 75.44294217958266, 75.44294217958263, 75.44303814425805, 75.44303814425817, 75.44294217958266, 75.4426967962966, 75.44269679629652, 75.44294217958266, 77.74536052741142, 74.41729147482923, 74.41743252536209, 74.41506875244696, 74.41729147482923, 74.41729147482923, 74.41712884986748, 74.41712884986725, 74.41729147482923, 74.41715542723136, 74.41715542723134, 74.41729147482923, 72.97838800412855, 72.97869455467887, 72.97989499083904, 72.97838800412856, 72.97838800412855, 72.98068954396744, 72.9806895439695, 72.97838800412855, 72.97792880866483, 72.97792880866477, 72.97838800412856, 77.79055814181659, 71.5088796610685, 71.50902631817368, 71.50756351009233, 71.5088796610685, 71.5088796610685, 71.50821373057433, 71.50821373057353, 71.5088796610685, 71.50872618367394, 71.50872618367394, 71.5088796610685, 69.95947259213453, 69.95976438496356, 69.95998352556816, 69.95947259213453, 69.95947259213453, 69.966712813357, 69.96671281336316, 69.95947259213453, 69.95904041949277, 69.95904041949274, 69.95947259213453, 139.95282850840826, 69.18126903812025, 69.18146228981496, 69.18089199333083, 69.18126903812025, 69.18126903812023, 69.18208173918039, 69.18208173918069, 69.18126903812025, 69.18102358057334, 69.18102358057328, 69.18126903812025, 68.31319527276318, 68.31333076365593, 68.31248344380907, 68.31319527276315, 68.31319527276315, 68.30960172450852, 68.30960172450446, 68.31319527276318, 68.31305425427412, 68.31305425427409, 68.31319527276315, 66.73737304589804, 66.7375723565193, 66.7372028493554, 66.73737304589802, 66.73737304589801, 66.74053272937948, 66.74053272938116, 66.73737304589804, 66.73711221564774, 66.73711221564774, 66.73737304589802, 68.22341228261651, 65.4244398193269, 65.42458466620938, 65.42416311749639, 65.42443981932693, 65.4244398193269, 65.41645857555075, 65.41645857554117, 65.4244398193269, 65.42427578056254, 65.42427578056252, 65.42443981932693, 63.29108813048044, 63.29136826291909, 63.29112181830676, 63.29108813048044, 63.291088130480425, 63.3582698806041, 63.358269880668544, 63.29108813048044, 63.29068065482845, 63.29068065482841, 63.29108813048044, 83.08703440576764, 62.20421890890952, 62.20439390473117, 62.20415975020001, 62.20421890890951, 62.20421890890948, 62.20371070454354, 62.203710704539176, 62.20421890890952, 62.20399854082109, 62.20399854082108, 62.20421890890951, 60.882161633278535, 60.882298532979206, 60.88210088507866, 60.882161633278535, 60.88216163327851, 60.8502881918703, 60.85028819182911, 60.882161633278535, 60.88200588807949, 60.882005888079476, 60.882161633278535, 58.33793221824493, 58.33814360225693, 58.33792730491443, 58.33793221824493, 58.33793221824491, 58.42735027495155, 58.42735027506442, 58.33793221824493, 58.33764849476515, 58.33764849476515, 58.337932218244916, 57.86543101207061, 57.86593031885948, 57.865396876557575, 57.86543101207061, 57.8654310120706, 62.70444739506596, 62.70444738513839, 57.86543101207061, 57.86468675902281, 57.86468675902297, 57.86543101207061, 49.05077593943687, 49.05095236713193, 49.05078076736612, 49.05077593943687, 49.050775939436846, 49.859520804870215, 49.859520802584974, 49.05077593943687, 49.05055976462568, 49.05055976462571, 49.05077593943687, 42.91192150006144, 42.912085745283036, 42.91191682076229, 42.91192150006144, 42.911921500061425, 48.23153199557581, 48.231532067920384, 42.91192150006144, 42.91172546836328, 42.911725468363144, 42.91192150006144, 31.59893881791586, 31.59906896468171, 31.59894973782305, 31.59893881791586, 31.59893881791585, 136.0290927128513, 136.02909299077925, 31.59893881791586, 31.598793116756397, 31.598793116757033, 31.59893881791586, 19.58375559860369, 19.583736659823177, 19.58274201779262, 19.58375559860369, 19.583755598603688, 18.914036746301985, 18.91403560972984, 19.58375559860369, 19.58377074690938, 19.583770746910115, 19.58375559860369, 23.65355579584305, 102.2955492860852, 17.834910033935014, 17.834898996134857, 17.83529268932284, 17.834910033935014, 17.83491003393501, 17.579933399014948, 17.57993296458643, 17.834910033935014, 17.834924903670395, 17.83492490367089, 17.834910033935014, 16.3023543258884, 16.302357978634703, 16.29623828910178, 16.302354325888395, 16.30235432588839, 17.282950708203572, 17.28295318230795, 16.3023543258884, 16.30233904091893, 16.30233904091479, 16.302354325888395, 25.210790228747406, 15.784800057002098, 15.784802710055946, 15.781810759093513, 15.784800057002098, 15.784800057002094, 16.827666590845563, 16.827669037963084, 15.784800057002098, 15.784791052454802, 15.784791052452414, 15.784800057002094, 15.94617063736493, 15.751074511246653, 15.751076430686863, 15.749353421002484, 15.751074511246653, 15.751074511246651, 16.796463795803472, 16.796466168643033, 15.751074511246653, 15.751069302081197, 15.75106930207939, 15.751074511246653, 15.80098103332672, 15.75968763861707, 15.751074511246653]
lm_imag = [118.88975883767613, 118.88975883767613, 118.88975883767613, 118.88976243169434, 118.88975524365793, 118.88976064045596, 118.88975703489625, 118.88975883767613, 118.88975883767613, 118.88975883767613, 118.88975883767613, 118.88975883767613, 118.88975883767613, 118.52942103354675, 118.52406562844092, 118.53028227224043, 118.526720858292, 118.5317765602687, 118.52955293046787, 118.52955293046787, 118.52943530483954, 118.52942113826178, 118.52942113826178, 118.52942104488254, 118.88978993733316, 100.03346845120303, 100.02187726526755, 100.02754379566112, 100.03346845183911, 100.03346845192918, 100.03346141619552, 100.03346141619552, 100.03346845120316, 100.02065453387303, 100.02065453387303, 100.0334684512022, 112.9116223149675, 115.1181327232637, 119.45824351306175, 128.27283633894885, 99.81642669697642, 99.81842176753256, 99.83840581357777, 99.816426697612, 99.81642669770196, 99.81641980595587, 99.81641980595587, 99.81642669697656, 99.80412448846421, 99.80412448846421, 99.81642669697557, 99.19996048203849, 99.19922995961961, 99.21376335932885, 99.19996048267225, 99.199960482762, 99.19995362730667, 99.19995362730667, 99.19996048203863, 99.18802420614803, 99.18802420614803, 99.19996048203765, 98.20081285129378, 98.20249552173533, 98.2019020551285, 98.2008128519248, 98.20081285201411, 98.20080624232078, 98.20080624232078, 98.20081285129392, 98.19008210418363, 98.19008210418363, 98.20081285129292, 96.7680081014901, 96.75520482727153, 96.76643406081678, 96.76800810211748, 96.7680081022063, 96.76800234602729, 96.76800234602729, 96.76800810149022, 96.76083087777167, 96.76083087777167, 96.76800810148924, 108.24804598065452, 96.51286445262157, 96.52362866852886, 96.51236073325896, 96.51286445324834, 96.51286445333707, 96.51285885960931, 96.51285885960931, 96.51286445262171, 96.50640304994641, 96.50640304994641, 96.51286445262073, 96.33773723160405, 96.32721462168531, 96.33760175708622, 96.33773723223044, 96.33773723231909, 96.33773181085662, 96.33773181085662, 96.33773723160418, 96.33199640012964, 96.33199640012964, 96.33773723160321, 96.19006897468519, 96.20179975547072, 96.1900396098319, 96.19006897531123, 96.19006897539985, 96.19006371977868, 96.19006371977869, 96.19006897468532, 96.18502365843612, 96.18502365843612, 96.19006897468432, 96.10624537567215, 96.09304363829928, 96.10623915775165, 96.10624537629805, 96.10624537638667, 96.10624027502412, 96.10624027502412, 96.10624537567229, 96.1018275395494, 96.1018275395494, 96.1062453756713, 95.9513480293561, 95.95120873187018, 95.95134427607803, 95.95134802998157, 95.95134803007012, 95.95134297152357, 95.95134297152357, 95.95134802935624, 95.9471873442844, 95.9471873442844, 95.95134802935526, 95.86146460128994, 95.86164047806737, 95.86146423737134, 95.86146460191526, 95.86146460200378, 95.86145968423556, 95.86145968423556, 95.86146460129008, 95.85790042927043, 95.85790042927043, 95.8614646012891, 95.72450881777709, 95.72375195071045, 95.72450922479426, 95.72450881840223, 95.72450881849072, 95.72450418495205, 95.72450418495205, 95.72450881777723, 95.7221518882021, 95.7221518882021, 95.72450881777627, 95.68122251847987, 95.69232196156253, 95.68122037041755, 95.68122251910532, 95.68122251919387, 95.68121844746244, 95.68121844746244, 95.68122251848, 95.68124440221789, 95.68124440221789, 95.68122251847902, 95.78038922040213, 95.61579181334565, 95.61611110370505, 95.61579050228511, 95.6157918139709, 95.61579181405942, 95.6157877286527, 95.6157877286527, 95.6157918133458, 95.6158126304026, 95.6158126304026, 95.61579181334483, 95.66008759258042, 95.61620048033068, 95.61581418923423, 95.61579334901495, 95.61579106894396, 95.6160607014215, 95.61578983945735, 95.61579106956918, 95.6157910696577, 95.61578698376124, 95.61578698376124, 95.61579106894412, 95.61581169235666, 95.61581169235666, 95.61579106894314, 95.61579093393281, 95.61603723778914, 95.61578974700272, 95.61579093455804, 95.61579093464655, 95.6157868484779, 95.6157868484779, 95.61579093393296, 95.61581145069877, 95.61581145069877, 95.61579093393196, 95.6157908682116, 95.61602042469009, 95.61578967403774, 95.61579082907984, 95.61579082916832, 95.61578674278307, 95.61578674278307, 95.61579082845472, 95.61581126085419, 95.61581126085419, 95.61579082845375, 95.61579080594686, 95.61579080594686]
bo_real = [80.80038877107911, 88.36379938306573, 110.3257509497122, 109.90740020987639, 113.79632270621612, 87.7868928833512, 86.68030266219547, 87.72621514219537, 88.11941173260747, 33.44043071019694, 93.24351342478754, 88.62394253672765, 73.85126116773873, 4.58525929821955, 79.21901220352592, 79.92545015419739, 97.13304709370333, 91.7547285278978, 4.59779213113441, 87.71734854680416, 4.400230696320972, 89.64585416705296, 89.63438384073666, 4.368615010114807, 4.715515892783867, 78.51247963021595, 41.75410038563834, 3.472664747474792, 4.436713867655428, 79.17353500238961, 3.99868882908591, 13.085074078675593, 83.46578507517751, 4.243073698222375, 15.681682702188045, 15.67977418084778, 0.08742856377376351, 124.24270476973638, 5.746519595118899, 17.845584650365556, 75.62534533181855, 79.34681148448746, 64.65636871919456, 9.16016495346737, 88.22450525858143, 59.41747524772435, 89.72915062933997, 73.23170974890354, 85.51795911708015, 87.69130810691114]
bo_imag = [3.4700325697240784, 4.975623482105577, 95.64277309331253, 107.16680846385094, 94.44089694787972, 41.62541942515117, 64.44144577846693, 96.18205722082236, 64.77662018173804, 7.978570385505725, 115.92186008145184, 101.8527286326789, 8.543374393188298, 4.391700956452015, 6.101580004395493, 5.729240021628444, 118.46655787337538, 7.978671952283307, 3.484923552944149, 95.23996165688618, 4.719413716183596, 102.17197647718763, 49.10906581516233, 2.795419320403751, 3.6093012660603208, 0.36029358790137256, 3.5902938025386377, 7.684116319425444, 3.615773361456721, 3.5965554649619813, 3.5008147628132598, 6.958363700751349, 105.51550097495972, 3.517500254644118, 7.894987899483544, 7.949749569052874, 0.3611272770170452, 115.52278419253899, 2.8120597009197446, 9.408665647362698, 3.0483841933808047, 3.635676427249997, 3.1415320416160974, 3.4314494713282464, 94.0178895833894, 70.36164080231691, 76.54944282204143, 3.5794690791435024, 94.33298875732956, 7.978621806784645]

# Calculate best-so-far for BO
bo_real_best = np.minimum.accumulate(bo_real)
bo_imag_best = np.minimum.accumulate(bo_imag)

max_iter = 50  # Cut x-axis at 50 for fair comparison

plt.figure(figsize=(12, 6))

# Real part subplot
plt.subplot(1, 2, 1)
plt.plot(lm_real[:max_iter], label='LM Real', color='tab:blue')
plt.plot(bo_real[:max_iter], label='BO Real', color='tab:green', marker='o', linestyle='--', alpha=0.6)
plt.plot(bo_real_best[:max_iter], label='BO Real (Best so far)', color='tab:green', linestyle='-')
plt.yscale('log')
plt.xlabel('Iteration', fontsize=12)
plt.ylabel('MSE (Real part)', fontsize=12)
plt.title('Real Part Error History', fontsize=14)
plt.legend()
plt.grid(True, which='both', ls='--', alpha=0.6)

# Imag part subplot
plt.subplot(1, 2, 2)
plt.plot(lm_imag[:max_iter], label='LM Imag', color='tab:orange')
plt.plot(bo_imag[:max_iter], label='BO Imag', color='tab:red', marker='o', linestyle='--', alpha=0.6)
plt.plot(bo_imag_best[:max_iter], label='BO Imag (Best so far)', color='tab:red', linestyle='-')
plt.yscale('log')
plt.xlabel('Iteration', fontsize=12)
plt.ylabel('MSE (Imag part)', fontsize=12)
plt.title('Imaginary Part Error History', fontsize=14)
plt.legend()
plt.grid(True, which='both', ls='--', alpha=0.6)

plt.tight_layout()
plt.suptitle('Error History Comparison: LM vs BO (Ionic Model)', fontsize=16, y=1.05)
plt.subplots_adjust(top=0.85)
plt.show()
